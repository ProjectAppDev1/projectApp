<!DOCTYPE html>
<html lang="en">

<head>
    
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Admin</title>
        <link rel="stylesheet" href="/css/admin.css">
        <link rel="stylesheet" href="/css/admin-forms/manage-wine-form.css">
        <link rel="stylesheet" href="/css/admin-forms/manage-branches-form.css">
        <link rel="stylesheet" href="/css/admin-forms/manage-admins-form.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <link rel="stylesheet" href="/assets/bootstrap/css/admin.css">
       <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
       <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap">
</head>
<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f0f5f9;
        margin: 0;
        padding: 0;
    }

    .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
    }

    .navbar {
        background-color: #3763f4;
    }

    .navbar-brand {
        color: white;
        font-weight: bold;
    }
  
    #wineTable {
        border: none;
        border-radius: 15px;
        box-shadow: 0px 0px 20px rgba(55, 99, 244, 0.5); /* Blue shadow */
        background-color: white;
        
        margin-top: 20px;
        overflow: hidden;
    }

    #wineTable thead {
        background-color: #3763f4;
        color: white;
    }

    #wineTable th, #wineTable td {
        padding: 15px;
        text-align: left;
    }

    #wineTable tbody tr:nth-child(even) {
        background-color: #f2f2f2;
    }

    #wineTable tbody tr:hover {
        background-color: #ddd;
    }

    .navbar-nav  {
        color: white;
    }

    .navbar-toggler-icon {
        background-color: white;
    }

    h1, h5 {
        color: #3763f4;
        padding: 5px ;
        text-align: center;
    }

    .btn-row {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 20px;
    }

    button {
        background-color: #3763f4;
        color: white;
        border: none;
        width: 150px;
        height: 50px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        margin: 5px;
    }

    button:hover {
        background-color: #2146b6;
    }

    button a {
        text-decoration: none;
        color: white;
        display: block;
    }
    
    th, td {
        padding: 10px;
        text-align: left;
    }

    th {
        background-color: #3763f4;
    }

    tr:nth-child(even) {
        background-color: #3763f4;
        border-radius: 15px;
    }

    tr:hover {
        background-color: #ddd;
    }

    #wineTable {
        border: 1px solid gray;
        border-radius: 15px;
    }

    #wineTable tbody {
        display: block;
        height: 200px;
        overflow: scroll;
    }

    .table-container {
      
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
    }
    #search-order{

        background-color: #3763f4;
        color: white;
        border: none;
        width: 120px;
        height: 40px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        margin: 10px;

    }
    h6{
         
        color: #3763f4;
        margin: 5px;
    }
    
   
</style>

</head>

<body>
    <nav class="navbar navbar-light navbar-expand-md sticky-top navbar-shrink py-3" id="mainNav">
        <div class="container"><a class="navbar-brand d-flex align-items-center" href="/"><span class="bs-icon-sm bs-icon-circle bs-icon-primary shadow d-flex justify-content-center align-items-center me-2 bs-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" fill="none"  stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="bi bi-new-icon" viewBox="0 0 16 16">
                <image xlink:href="https://www.svgrepo.com/show/530620/wine.svg" width="18" height="18" />
            </svg>
           </span><span>TAMY</span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navcol-1">
                      <ul class="navbar-nav mx-auto">
                          <li class="nav-item"><a class="nav-link" href='http://localhost:5000/'>Home</a></li>
                          <li class="nav-item"><a class="nav-link" href="Products">Products</a></li>
                          <li class="nav-item"><a class="nav-link" href="about">about</a></li>
                          <li class="nav-item"><a class="nav-link" href="Contact">Contact</a></li>
                          <li class="nav-item"><a class="nav-link" href="PrivateArea">Private area</a></li>
                          <li class="nav-item"><a class="nav-link" href="cart">My Cart</a></li>
                      </ul>
                  </div>
  </nav>
        <h1>Admin page</h1>
       <h5>  Manage Your Website</h5>

               
                <div   class="btn-row" id="navbar">
                    <button onclick="postToFacebook()" id="postToFacebookButton">Post to facebook</button>
                    <button class="nav-item"> 
                       
                        <a id="createWineFormLink" href="/admin/create-wine">Add new wine</a> 
                    </button>
                  
                   
                    <button class="nav-item">
                        <a id="createBranchFormLink" href="/admin/create-branch">Add new branch</a>
                    </button>
                    <button class="nav-item">
                        <a id="createAdminFormLink" href="/admin/create-admin">Add Admin</a>
                    </button>
                </div>
                <div class="table-container">
                    <h6> Orders History :</h6>
                    <input type="text" id="order-search-input" placeholder="Enter Parameter" />
                    <button id="search-order" onclick="searchOrder()">search</button>
                    <table id="wineTable">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Created Date</th>
                                <th>Wine Names</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                          
                           
                        </tbody>
                    </table>
                </div>
    </header>
 
                
            
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bold-and-bright.js"></script>
    <script>
        const searchOrder = async() => {
            const userId = document.getElementById("order-search-input").value;
            const orders = await $.ajax(`/orders/${userId}`);
            console.log(orders);
            renderTable(orders);
        }
        function loadManageWines(){
            window.location.href = "/admin/manageWine";
        }
        const postToFacebook = () => {
            const accessToken = `EAADTedh7DDgBOxaBoy5riJwUTZCOuNpOjxLWSoSZBkqSnz2BfecxwdIZBZCvDm4D5Ut8g8kYDL2L0brkIKH4JZAtONor5ZCjUBENgx1ZBAZBVUaJfzSHKjK9eFBi2fZC8vWUAyXu9JjUhbcVXpFcvSfa2FB0bZComirED8B38okC9EZCgdbPXFEffZCTp4JugvenK0pbO5vm1WXaC98YWCBBzTzkhzIZD`;

            const pageId = '106948385754099';
    
            const message = `its wine o'clock somewhere`;
    
            const apiUrl = `https://graph.facebook.com/v16.0/${pageId}/feed`;
    
            const postData = {
                message,
                access_token:accessToken
            }
    
            $.ajax({
                url: apiUrl,
                type: "POST",
                data: postData,
                success: response => {
                    alert("success")
                },
                error: response => {
                    alert("error")
                }
            })
        }
        
        const renderTable = (data) => {
            const tableBody = document.getElementById("tableBody");
            tableBody.innerHTML = ''

            data.forEach(item => {
                const row = document.createElement("tr");
                const userIdCell = document.createElement("td");
                const createdDateCell = document.createElement("td");
                const wineNamesCell = document.createElement("td");

                userIdCell.textContent = item.userId;
                createdDateCell.textContent = new Date(item.createdAt).toLocaleDateString();

                const wineNames = item.wines.map(wine => wine.name).join(", ");
                wineNamesCell.textContent = wineNames;

                row.appendChild(userIdCell);
                row.appendChild(createdDateCell);
                row.appendChild(wineNamesCell);

                tableBody.appendChild(row);
            });
        }

        const loadAllOrder = async () => {
            const allOrders = await $.ajax("/orders");
            console.log(JSON.stringify(allOrders[3]));
            renderTable(allOrders);
        }
        loadAllOrder();
    </script>
        <div id="admin-panel"></div>
</body>
<div class="text-muted d-flex justify-content-between align-items-center pt-3">
    <p class="mb-0">Copyright Â© 2023 Tamy</p>
  </div>

</footer>
      

</html>